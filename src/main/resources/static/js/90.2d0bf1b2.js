"use strict";(self["webpackChunkdemo"]=self["webpackChunkdemo"]||[]).push([[90],{6090:function(e,t,s){s.r(t),s.d(t,{default:function(){return u}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"accounting-subject-container"},[t("div",{staticClass:"header"},[t("h2",[e._v("会计科目管理")]),t("el-button",{attrs:{type:"primary"},on:{click:e.showAddDialog}},[e._v("新增科目")])],1),t("div",{staticClass:"content"},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:6}},[t("el-card",[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("科目树")])]),t("el-tree",{ref:"subjectTreeRef",attrs:{data:e.subjectTree,props:e.defaultProps,"node-key":"id","default-expand-all":""},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function({node:s,data:a}){return[t("span",{staticClass:"custom-tree-node"},[t("span",[e._v(e._s(a.code)+" - "+e._s(a.name))]),1===a.status?t("span",[t("el-tag",{attrs:{size:"small",type:"success"}},[e._v("启用")])],1):t("span",[t("el-tag",{attrs:{size:"small",type:"danger"}},[e._v("禁用")])],1)])]}}])})],1)],1),t("el-col",{attrs:{span:18}},[e.selectedSubject?t("el-card",[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("div",[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.showEditDialog}},[e._v("编辑")]),t("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.deleteSubject}},[e._v("删除")]),t("el-button",{attrs:{size:"small"},on:{click:e.toggleEnable}},[e._v(" "+e._s(1===e.selectedSubject.status?"禁用":"启用")+" ")])],1)]),t("el-descriptions",{attrs:{column:1,border:""}},[t("el-descriptions-item",{attrs:{label:"科目编码"}},[e._v(e._s(e.selectedSubject.code))]),t("el-descriptions-item",{attrs:{label:"科目名称"}},[e._v(e._s(e.selectedSubject.name))]),t("el-descriptions-item",{attrs:{label:"科目类型"}},[e._v(e._s(this.getTypeText(e.selectedSubject.type)))]),t("el-descriptions-item",{attrs:{label:"余额方向"}},[e._v(e._s(1===e.selectedSubject.balanceDirection?"借":"贷"))]),t("el-descriptions-item",{attrs:{label:"状态"}},[e._v(e._s(1===e.selectedSubject.status?"启用":"禁用"))])],1)],1):t("el-empty",{attrs:{description:"请选择一个科目查看详情"}})],1)],1)],1),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"subjectFormRef",attrs:{model:e.subjectForm,rules:e.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"科目编码",prop:"code"}},[t("el-input",{attrs:{placeholder:"请输入科目编码"},model:{value:e.subjectForm.code,callback:function(t){e.$set(e.subjectForm,"code",t)},expression:"subjectForm.code"}})],1),t("el-form-item",{attrs:{label:"科目名称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入科目名称"},model:{value:e.subjectForm.name,callback:function(t){e.$set(e.subjectForm,"name",t)},expression:"subjectForm.name"}})],1),t("el-form-item",{attrs:{label:"科目类型",prop:"type"}},[t("el-select",{attrs:{placeholder:"请选择科目类型"},model:{value:e.subjectForm.type,callback:function(t){e.$set(e.subjectForm,"type",t)},expression:"subjectForm.type"}},[t("el-option",{attrs:{label:"资产",value:1}}),t("el-option",{attrs:{label:"负债",value:2}}),t("el-option",{attrs:{label:"共同",value:3}}),t("el-option",{attrs:{label:"所有者权益",value:4}}),t("el-option",{attrs:{label:"成本",value:5}}),t("el-option",{attrs:{label:"损益",value:6}})],1)],1),t("el-form-item",{attrs:{label:"余额方向",prop:"balanceDirection"}},[t("el-radio-group",{model:{value:e.subjectForm.balanceDirection,callback:function(t){e.$set(e.subjectForm,"balanceDirection",t)},expression:"subjectForm.balanceDirection"}},[t("el-radio",{attrs:{label:1}},[e._v("借")]),t("el-radio",{attrs:{label:2}},[e._v("贷")])],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确定")])],1)],1)],1)},l=[],r=s(7277),i={name:"AccountingSubject",data(){return{subjectTree:[],selectedSubject:null,dialogVisible:!1,isAddDialog:!0,dialogTitle:"新增科目",subjectForm:{code:"",name:"",type:"",balanceDirection:"1",parentId:0,status:1},defaultProps:{children:"children",label:e=>`${e.code} - ${e.name}`},rules:{code:[{required:!0,message:"请输入科目编码",trigger:"blur"}],name:[{required:!0,message:"请输入科目名称",trigger:"blur"}],type:[{required:!0,message:"请选择科目类型",trigger:"change"}],balanceDirection:[{required:!0,message:"请选择余额方向",trigger:"change"}]}}},computed:{isAddDialog(){return!this.subjectForm.id}},created(){this.loadSubjectTree()},methods:{async loadSubjectTree(){try{const e=await r.A.get("/accounting-subject/tree");200===e.code&&this.buildTreeData(e.data)}catch(e){this.$message.error("加载科目树失败")}},buildTreeData(e){this.subjectTree=e},getTypeText(e){const t={1:"资产",2:"负债",3:"共同",4:"所有者权益",5:"成本",6:"损益"};return t[e]||e},handleNodeClick(e){this.selectedSubject=e},showAddDialog(){this.dialogTitle="新增科目",this.resetForm(),this.dialogVisible=!0},showEditDialog(){this.dialogTitle="编辑科目",this.subjectForm={...this.selectedSubject},this.dialogVisible=!0},resetForm(){this.subjectForm={code:"",name:"",type:"",balanceDirection:"1",parentId:0,status:1},this.$refs.subjectFormRef&&this.$refs.subjectFormRef.resetFields()},async submitForm(){this.$refs.subjectFormRef.validate(async e=>{if(e)try{let e;this.subjectForm.id?(e=await r.A.put("/accounting-subject/update",this.subjectForm),this.selectedSubject=this.subjectForm):e=await r.A.post("/accounting-subject/add",this.subjectForm),200===e.code?(this.$message.success(e.message||(this.isAddDialog?"新增成功":"更新成功")),this.dialogVisible=!1,this.loadSubjectTree()):this.$message.error(e.message||(this.isAddDialog?"新增失败":"更新失败"))}catch(t){this.$message.error(this.isAddDialog?"新增失败":"更新失败")}})},async deleteSubject(){this.$confirm("确定要删除这个科目吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const e=await r.A.delete(`/accounting-subject/delete/${this.selectedSubject.id}`);200===e.code?(this.$message.success("删除成功"),this.loadSubjectTree(),this.selectedSubject=null):this.$message.error(e.message||"删除失败")}catch(e){this.$message.error("删除失败")}}).catch(()=>{this.$message.info("已取消删除")})},async toggleEnable(){const e=1===this.selectedSubject.status?0:1;try{const t=await r.A.put(`/accounting-subject/enable/${this.selectedSubject.id}?enabled=${e}`);200===t.code?(this.$message.success(1===e?"启用成功":"禁用成功"),this.selectedSubject.status=e):this.$message.error(t.message||"操作失败")}catch(t){this.$message.error("操作失败")}}}},o=i,c=s(1656),n=(0,c.A)(o,a,l,!1,null,"e5f66ca0",null),u=n.exports},7277:function(e,t,s){var a=s(4373),l=s(5129),r=s(9143);const i=a.A.create({timeout:5e3});i.interceptors.request.use(e=>(l.A.state.token&&(e.headers["Authorization"]="Bearer "+l.A.state.token),e),e=>(console.log(e),Promise.reject(e))),i.interceptors.response.use(e=>{const t=e.data;return 200!==t.code?((0,r.Message)({message:t.message||"请求失败",type:"error",duration:5e3}),Promise.reject(new Error(t.message||"请求失败"))):t},e=>(e.response&&401===e.response.status&&(l.A.dispatch("logout"),location.reload()),(0,r.Message)({message:e.message||"网络异常",type:"error",duration:5e3}),Promise.reject(e))),t.A=i}}]);
//# sourceMappingURL=90.2d0bf1b2.js.map