"use strict";(self["webpackChunkdemo"]=self["webpackChunkdemo"]||[]).push([[891],{3891:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var s=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"tax-handling-container"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("税务处理")]),t("el-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.handleAddTax}},[e._v("新增税务处理")])],1),t("div",{staticClass:"search-container"},[t("el-form",{staticClass:"search-form",attrs:{inline:!0,model:e.searchForm}},[t("el-form-item",{attrs:{label:"税务类型："}},[t("el-select",{attrs:{placeholder:"请选择税务类型"},model:{value:e.searchForm.taxType,callback:function(t){e.$set(e.searchForm,"taxType",t)},expression:"searchForm.taxType"}},[t("el-option",{attrs:{label:"增值税",value:"vat"}}),t("el-option",{attrs:{label:"企业所得税",value:"income_tax"}}),t("el-option",{attrs:{label:"城市维护建设税",value:"urban_tax"}}),t("el-option",{attrs:{label:"教育费附加",value:"education_surcharge"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),t("el-button",{on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.taxList}},[t("el-table-column",{attrs:{prop:"taxPeriod",label:"税务期间"}}),t("el-table-column",{attrs:{prop:"taxType",label:"税务类型"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e.getTaxTypeName(a.row.taxType)))])]}}])}),t("el-table-column",{attrs:{prop:"taxAmount",label:"应纳税额"}}),t("el-table-column",{attrs:{prop:"status",label:"处理状态"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getStatusType(a.row.status)}},[e._v(e._s(e.getStatusName(a.row.status)))])]}}])}),t("el-table-column",{attrs:{prop:"paymentDate",label:"缴款日期"}}),t("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[2!==a.row.status?t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]):e._e(),[0].includes(a.row.status)?t("el-button",{attrs:{size:"small",type:"success"},on:{click:function(t){return e.handleDeclare(a.row)}}},[e._v("申报")]):e._e(),1===a.row.status?t("el-button",{attrs:{size:"small",type:"warning"},on:{click:function(t){return e.handlePay(a.row)}}},[e._v("缴款")]):e._e()]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":e.pageInfo.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pageInfo.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,rules:e.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"税务期间",prop:"taxPeriod"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"month",placeholder:"选择月份",disabled:"view"===e.dialogMode},model:{value:e.formData.taxPeriod,callback:function(t){e.$set(e.formData,"taxPeriod",t)},expression:"formData.taxPeriod"}})],1),t("el-form-item",{attrs:{label:"税务类型",prop:"taxType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择税务类型",disabled:"view"===e.dialogMode},model:{value:e.formData.taxType,callback:function(t){e.$set(e.formData,"taxType",t)},expression:"formData.taxType"}},[t("el-option",{attrs:{label:"增值税",value:"vat"}}),t("el-option",{attrs:{label:"企业所得税",value:"income_tax"}}),t("el-option",{attrs:{label:"城市维护建设税",value:"urban_tax"}}),t("el-option",{attrs:{label:"教育费附加",value:"education_surcharge"}})],1)],1),t("el-form-item",{attrs:{label:"应纳税额",prop:"taxAmount"}},[t("el-input",{attrs:{type:"number",placeholder:"请输入应纳税额",disabled:"view"===e.dialogMode},model:{value:e.formData.taxAmount,callback:function(t){e.$set(e.formData,"taxAmount",e._n(t))},expression:"formData.taxAmount"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),"view"!==e.dialogMode?t("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确定")]):e._e()],1)],1)],1)},i=[],o=(a(4603),a(7566),a(8721),a(4373)),r=a(412);const l={page:e=>(0,r.Ay)({url:"/tax-handling/page",method:"get",params:e}),getList:e=>o.A.get("/tax-handling/list",{params:e}),getById:e=>o.A.get(`/tax-handling/${e}`),save:e=>{const t={id:e.id,taxType:e.taxType,taxPeriod:e.taxPeriod,taxAmount:e.taxAmount,paymentDate:e.paymentDate,status:e.status};return e.id?o.A.put("/tax-handling",t):o.A.post("/tax-handling",t)},declare:e=>o.A.post(`/tax-handling/declare/${e}`),pay:e=>o.A.post(`/tax-handling/pay/${e}`),delete:e=>o.A.delete(`/tax-handling/${e}`),exportReport:e=>o.A.get("/tax-handling/export",{params:e,responseType:"blob"})};var n={name:"TaxHandling",data(){return{loading:!1,taxList:[],searchForm:{taxPeriod:"",taxType:"",status:""},pageInfo:{currentPage:1,pageSize:10,total:0},dialogVisible:!1,dialogMode:"add",dialogTitle:"新增税务处理",formData:{id:"",taxType:"",taxPeriod:"",taxAmount:0,paymentDate:"",status:0},rules:{taxPeriod:[{required:!0,message:"请选择税务期间",trigger:"change"}],taxType:[{required:!0,message:"请选择税务类型",trigger:"change"}],taxAmount:[{required:!0,message:"请输入应纳税额",trigger:"blur"},{type:"number",min:0,message:"应纳税额必须大于等于0",trigger:"blur"}]}}},created(){this.loadData()},methods:{async loadData(){this.loading=!0;try{const e={page:this.pageInfo.currentPage,pageSize:this.pageInfo.pageSize,...this.searchForm},t=await l.page(e),a=t.data||{};this.taxList=a.records||[],this.pageInfo.total=a.total||0}catch(e){this.$message.error("获取税务处理列表失败: "+(e.response?.data?.message||e.message))}finally{this.loading=!1}},handleSearch(){this.pageInfo.currentPage=1,this.loadData()},handleReset(){this.searchForm={taxPeriod:"",taxType:"",status:""},this.pageInfo.currentPage=1,this.loadData()},handleSizeChange(e){this.pageInfo.pageSize=e,this.loadData()},handleCurrentChange(e){this.pageInfo.currentPage=e,this.loadData()},handleAddTax(){this.dialogMode="add",this.dialogTitle="新增税务处理",this.resetForm(),this.dialogVisible=!0},async handleView(e){this.dialogMode="view",this.dialogTitle="查看税务处理";try{const t=await l.getById(e.id),a=t.data.data||{};this.formData={id:a.id||"",taxType:a.taxType||"",taxPeriod:a.taxPeriod||"",taxAmount:a.taxAmount||0,paymentDate:a.paymentDate||"",status:void 0!==a.status?a.status:0},this.dialogVisible=!0}catch(t){this.$message.error("获取税务处理详情失败: "+(t.response?.data?.message||t.message))}},async handleEdit(e){this.dialogMode="edit",this.dialogTitle="编辑税务处理";try{const t=await l.getById(e.id);this.formData={...t.data.data},this.dialogVisible=!0}catch(t){this.$message.error("获取税务处理详情失败: "+(t.response?.data?.message||t.message))}},async handleSubmit(){this.$refs.formRef.validate(async e=>{if(e)try{await l.save(this.formData),this.$message.success("add"===this.dialogMode?"新增成功":"编辑成功"),this.dialogVisible=!1,this.loadData()}catch(t){this.$message.error("保存失败: "+(t.response?.data?.message||t.message))}})},resetForm(){this.$refs.formRef&&this.$refs.formRef.resetFields(),this.formData={id:"",taxType:"",taxPeriod:"",taxAmount:0,paymentDate:"",status:0}},async handleDeclare(e){this.$confirm("确定要申报该税务处理记录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await l.declare(e.id),this.$message.success("申报成功"),this.loadData()}catch(t){this.$message.error("申报失败: "+(t.response?.data?.message||t.message))}}).catch(()=>{this.$message.info("已取消操作")})},async handlePay(e){this.$confirm("确定要缴纳该税款吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await l.pay(e.id),this.$message.success("缴款成功"),this.loadData()}catch(t){this.$message.error("缴款失败: "+(t.response?.data?.message||t.message))}}).catch(()=>{this.$message.info("已取消操作")})},async handleExport(){this.$confirm("确定要导出税务报表吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(async()=>{try{const e=await l.exportReport(this.searchForm),t=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=`税务报表_${(new Date).toISOString().slice(0,10)}.xlsx`,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(a),this.$message.success("导出成功")}catch(e){this.$message.error("导出失败: "+(e.response?.data?.message||e.message))}}).catch(()=>{this.$message.info("已取消操作")})},getTaxTypeName(e){const t={vat:"增值税",income_tax:"企业所得税",urban_tax:"城市维护建设税",education_surcharge:"教育费附加"};return t[e]||e},getStatusName(e){const t={0:"待申报",1:"已申报",2:"已缴纳"};return t[e]||"未知"},getStatusType(e){const t={0:"danger",1:"warning",2:"info",3:"success"};return t[e]||"default"}}},d=n,c=a(1656),m=(0,c.A)(d,s,i,!1,null,"5586bae6",null),u=m.exports}}]);
//# sourceMappingURL=891.7bd22b4d.js.map