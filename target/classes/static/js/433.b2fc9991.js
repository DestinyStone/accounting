"use strict";(self["webpackChunkdemo"]=self["webpackChunkdemo"]||[]).push([[433],{2433:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"reconciliation-container"},[t("el-card",[t("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("对账管理")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增对账")])],1),t("el-form",{staticClass:"search-form",attrs:{inline:!0,model:e.searchForm}},[t("el-form-item",{attrs:{label:"账户"}},[t("el-input",{attrs:{placeholder:"请输入账户"},model:{value:e.searchForm.accountId,callback:function(t){e.$set(e.searchForm,"accountId",t)},expression:"searchForm.accountId"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),t("el-button",{on:{click:e.resetSearch}},[e._v("重置")])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.reconciliationList}},[t("el-table-column",{attrs:{prop:"accountId",label:"账户"}}),t("el-table-column",{attrs:{prop:"reconciliationDate",label:"对账日期"}}),t("el-table-column",{attrs:{prop:"startBalance",label:"期初余额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatMoney(t.row.startBalance))+" ")]}}])}),t("el-table-column",{attrs:{prop:"endBalance",label:"期末余额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatMoney(t.row.endBalance))+" ")]}}])}),t("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getStatusType(a.row.status)}},[e._v(e._s(e.getStatusText(a.row.status)))])]}}])}),t("el-table-column",{attrs:{label:"操作",width:"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return e.handleDelete(a.row.id)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"",layout:"prev, pager, next, jumper, total",total:e.pageInfo.total,"current-page":e.pageInfo.pageNum,"page-size":e.pageInfo.pageSize},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),t("el-dialog",{attrs:{title:"对账信息",visible:e.dialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"formData",attrs:{model:e.formData,rules:e.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"账户",prop:"accountId"}},[t("el-input",{attrs:{placeholder:"请输入账户"},model:{value:e.formData.accountId,callback:function(t){e.$set(e.formData,"accountId",e._n(t))},expression:"formData.accountId"}})],1),t("el-form-item",{attrs:{label:"对账日期",prop:"reconciliationDate"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择对账日期","value-format":"yyyy-MM-dd"},model:{value:e.formData.reconciliationDate,callback:function(t){e.$set(e.formData,"reconciliationDate",t)},expression:"formData.reconciliationDate"}})],1),t("el-form-item",{attrs:{label:"期初余额",prop:"startBalance"}},[t("el-input",{attrs:{placeholder:"请输入期初余额"},model:{value:e.formData.startBalance,callback:function(t){e.$set(e.formData,"startBalance",e._n(t))},expression:"formData.startBalance"}})],1),t("el-form-item",{attrs:{label:"期末余额",prop:"endBalance"}},[t("el-input",{attrs:{placeholder:"请输入期末余额"},model:{value:e.formData.endBalance,callback:function(t){e.$set(e.formData,"endBalance",e._n(t))},expression:"formData.endBalance"}})],1),t("el-form-item",{attrs:{label:"状态",prop:"status"}},[t("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.formData.status,callback:function(t){e.$set(e.formData,"status",e._n(t))},expression:"formData.status"}},[t("el-option",{attrs:{label:"未对账",value:0}}),t("el-option",{attrs:{label:"已对账",value:1}}),t("el-option",{attrs:{label:"差异",value:2}}),t("el-option",{attrs:{label:"已确认",value:3}})],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确定")])],1)],1)],1)],1)},o=[],s=a(7277);function n(e){return(0,s.A)({url:"/reconciliation/page",method:"get",params:e})}function i(e){const t={id:e.id,accountId:e.accountId,reconciliationDate:e.reconciliationDate,startBalance:e.startBalance,endBalance:e.endBalance,status:e.status};return(0,s.A)({url:(e.id,"/reconciliation"),method:e.id?"put":"post",data:t})}function l(e){return(0,s.A)({url:`/reconciliation/${e}`,method:"delete"})}var c={name:"Reconciliation",data(){return{loading:!1,searchForm:{accountId:"",reconciliationDate:"",status:""},reconciliationList:[],pageInfo:{pageNum:1,pageSize:10,total:0},dialogVisible:!1,formData:{id:"",accountId:"",reconciliationDate:"",startBalance:0,endBalance:0,status:0},rules:{accountId:[{required:!0,message:"请输入账户",trigger:"blur"}],reconciliationDate:[{required:!0,message:"请选择对账日期",trigger:"change"}],startBalance:[{required:!0,message:"请输入期初余额",trigger:"blur"},{type:"number",message:"期初余额必须是数字",trigger:"blur"}],endBalance:[{required:!0,message:"请输入期末余额",trigger:"blur"},{type:"number",message:"期末余额必须是数字",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"},{type:"number",message:"状态必须是数字",trigger:"blur"}]}}},mounted(){this.getList()},methods:{async getList(){this.loading=!0;try{const e=await n({...this.searchForm,pageNum:this.pageInfo.pageNum,pageSize:this.pageInfo.pageSize}),t=e.data||{};this.reconciliationList=t.records||[],this.pageInfo.total=t.total||0}catch(e){this.$message.error("获取对账列表失败"),console.error(e)}finally{this.loading=!1}},handleSearch(){this.pageInfo.pageNum=1,this.getList()},resetSearch(){this.searchForm={accountId:"",reconciliationDate:"",status:""},this.getList()},handleCurrentChange(e){this.pageInfo.pageNum=e,this.getList()},handleSizeChange(e){this.pageInfo.pageSize=e,this.pageInfo.pageNum=1,this.getList()},handleAdd(){this.formData={id:"",accountId:"",reconciliationDate:"",startBalance:0,endBalance:0,status:0},this.dialogVisible=!0},async handleEdit(e){this.loading=!0;try{this.formData={...e},this.dialogVisible=!0}catch(t){this.$message.error("获取对账信息失败"),console.error(t)}finally{this.loading=!1}},handleDelete(e){this.$confirm("确定要删除这条对账记录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await l(e),this.$message.success("删除成功"),this.getList()}catch(t){this.$message.error("删除失败"),console.error(t)}}).catch(()=>{this.$message.info("已取消删除")})},async handleSubmit(){this.$refs.formData.validate(async e=>{if(e)try{await i(this.formData),this.$message.success("保存成功"),this.dialogVisible=!1,this.getList()}catch(t){this.$message.error("保存失败"),console.error(t)}})},formatMoney(e){return e?Number(e).toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"},getStatusText(e){const t={0:"未对账",1:"已对账",2:"差异",3:"已确认"};return t[e]||"未知"},getStatusType(e){const t={0:"default",1:"success",2:"warning",3:"info"};return t[e]||"default"}}},u=c,d=a(1656),m=(0,d.A)(u,r,o,!1,null,"aef26e1e",null),g=m.exports},7277:function(e,t,a){var r=a(4373),o=a(5129),s=a(9143);const n=r.A.create({timeout:5e3});n.interceptors.request.use(e=>(o.A.state.token&&(e.headers["Authorization"]="Bearer "+o.A.state.token),e),e=>(console.log(e),Promise.reject(e))),n.interceptors.response.use(e=>{const t=e.data;return 200!==t.code?((0,s.Message)({message:t.message||"请求失败",type:"error",duration:5e3}),Promise.reject(new Error(t.message||"请求失败"))):t},e=>(e.response&&401===e.response.status&&(o.A.dispatch("logout"),location.reload()),(0,s.Message)({message:e.message||"网络异常",type:"error",duration:5e3}),Promise.reject(e))),t.A=n}}]);
//# sourceMappingURL=433.b2fc9991.js.map